@if (isOpen) {
  <div class="sidebar-overlay" (click)="onClose()"></div>
}

<aside class="sidebar" [class.is-open]="isOpen">
  <!-- Блок фильтров -->
  <div class="sidebar__filters">
    <!-- Группа 1: Сортировка -->
    <nav class="sidebar__nav">
      <a
        [routerLink]="[]"
        [queryParams]="{ sort_by: 'newest' }"
        queryParamsHandling="merge"
        [class.active]="activeSort === 'newest'"
        (click)="onClose()"
        i18n="@@sidebar.sortNewest"
      >Новинки</a>
      <a
        [routerLink]="[]"
        [queryParams]="{ sort_by: 'top_rated' }"
        queryParamsHandling="merge"
        [class.active]="activeSort === 'top_rated'"
        (click)="onClose()"
        i18n="@@sidebar.sortTopRated"
      >Лучшее</a>
    </nav>

    <!-- Группа 2: Тип контента -->
    <nav class="sidebar__nav">
      <a
        routerLink="/all"
        [class.active]="activeType === 'all'"
        [queryParams]="{ genre: selectedGenres.length ? selectedGenres.join(',') : null }"
        queryParamsHandling="merge"
        (click)="onClose()"
        i18n="@@sidebar.typeAll"
      >Все</a>
      <a
        routerLink="/movie"
        [class.active]="activeType === 'movie'"
        [queryParams]="{ genre: selectedGenres.length ? selectedGenres.join(',') : null }"
        queryParamsHandling="merge"
        (click)="onClose()"
        i18n="@@sidebar.typeMovies"
      >Фильмы</a>
      <a
        routerLink="/tv"
        [class.active]="activeType === 'tv'"
        [queryParams]="{ genre: selectedGenres.length ? selectedGenres.join(',') : null }"
        queryParamsHandling="merge"
        (click)="onClose()"
        i18n="@@sidebar.typeTvShows"
      >Сериалы</a>
    </nav>
  </div>

  <!-- Блок для поиска -->
  <div class="sidebar__search">
    <app-search-bar
      [initialQuery]="initialQuery"
      placeholder="Поиск..."
      i18n-placeholder="@@sidebar.searchPlaceholder"
      (searchChange)="onSearchChange($event)"
    ></app-search-bar>
  </div>

  <div class="sidebar__section">
    <div class="sidebar__header">
      <h3>
        <span i18n="@@sidebar.genresTitleText">Жанры</span>
        @if (selectedGenres.length) {
          <span class="sidebar__genre-count">{{ selectedGenres.length }}</span>
        }
      </h3>
      @if (selectedGenres.length) {
        <button class="sidebar__reset-btn" (click)="resetGenres()" i18n="@@sidebar.resetFilters">Сбросить</button>
      }
    </div>

    <div class="sidebar__genres-container">
      <div class="genres-list">
        @for (genre of genres; track genre.id) {
          <label class="checkbox-label">
            <input
              type="checkbox"
              [checked]="isSelected(genre.id)"
              (change)="onGenreToggle($event, genre.id)"
            >
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">{{ genre.name }}</span>
          </label>
        }
      </div>
    </div>
  </div>
</aside>
