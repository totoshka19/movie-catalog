<app-header
  [activeType]="activeType()"
  [activeSort]="activeSort()"
  [selectedGenres]="selectedGenres()"
  [initialQuery]="searchQuery()"
  [placeholder]="searchPlaceholder()"
  (searchChange)="onSearch($event)"
></app-header>

<div class="page-layout">
  <app-sidebar
    [selectedGenres]="selectedGenres()"
    [genres]="allGenres()"
    [initialQuery]="searchQuery()"
    (genreChange)="onGenreChange($event)"
    (searchChange)="onSearch($event)"
  ></app-sidebar>

  <main class="content">
    @if (isLoading()) {
      <app-skeleton-list></app-skeleton-list>
    } @else if (error()) {
      <div class="app-state-indicator app-state-indicator--error">{{ error() }}</div>
    } @else {
      <app-movie-list
        [movies]="filteredMedia()"
        [emptyMessage]="emptyListMessage()"
        (movieClick)="onMediaSelect($event)"
      ></app-movie-list>

      @if (isLoadingMore()) {
        <div class="app-loading-more">
          <div class="spinner"></div>
        </div>
      }

      <div
        class="infinite-scroll-trigger"
        appInfiniteScroll
        [threshold]="500"
        [disabled]="isLoading() || isLoadingMore() || !hasMorePages"
        (scrollEnd)="loadNextPage()"
      ></div>
    }
  </main>
</div>
