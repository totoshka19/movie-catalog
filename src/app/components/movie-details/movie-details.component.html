<div class="movie-details__overlay" (click)="onClose()" [class.is-visible]="isVisible()">
  <article class="movie-details__content" (click)="onContentClick($event)">
    <button class="movie-details__close-btn" (click)="onClose()" aria-label="Закрыть">
      &times;
    </button>
    <div class="movie-details__poster">
      @if (movie.primaryImage?.url) {
        <img [src]="movie.primaryImage!.url" [alt]="'Постер ' + (movie.primaryTitle || movie.originalTitle)">
      } @else {
        <div class="movie-details__poster-placeholder">Нет постера</div>
      }
    </div>
    <div class="movie-details__info">
      <h2 class="movie-details__title">
        {{ movie.primaryTitle || movie.originalTitle }}
        @if (movie.startYear) {
          ({{ movie.startYear }})
        }
      </h2>
      <div class="movie-details__meta">
        @if (movie.rating && movie.rating.aggregateRating > 0) {
          <span class="movie-details__rating">★ {{ movie.rating.aggregateRating | number: '1.1-1' }}</span>
        }
        <!-- Исправлено: убран лишний ?. -->
        @if (movie.genres.length) {
          <div class="movie-details__genres">
            @for (genre of movie.genres; track genre) {
              <span class="movie-details__genre-tag">{{ genre }}</span>
            }
          </div>
        }
      </div>

      <p class="movie-details__description">{{ movie.plot || 'Описание отсутствует.' }}</p>

      <a class="movie-details__page-link" [routerLink]="['/media', movie.type, movie.id]">
        Подробнее
      </a>
    </div>
  </article>
</div>
